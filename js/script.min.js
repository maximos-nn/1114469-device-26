var contactLink=document.querySelector(".index-info-contacts .button"),feedback=document.querySelector(".modal-feedback"),feedbackCloseButton=feedback.querySelector(".button-close"),feedbackForm=feedback.querySelector(".feedback-form"),nameField=feedbackForm.querySelector("[name=name]"),emailField=feedbackForm.querySelector("[name=email]"),messageField=feedbackForm.querySelector("[name=message]"),mapLink=document.querySelector(".map-mini"),map=document.querySelector(".modal-map"),mapCloseButton=map.querySelector("button"),isStorageSupported=!0,storageName="",storageEmail="";try{storageName=localStorage.getItem("name"),storageEmail=localStorage.getItem("email")}catch(e){isStorageSupported=!1}function addControlHandler(a,t,o,l,s){a[o].addEventListener("click",function(){for(var e=0;e<t.length;e++)a[e].classList.remove(s),t[e].classList.remove(l);a[o].classList.add(s),t[o].classList.add(l)})}contactLink.addEventListener("click",function(e){e.preventDefault(),feedback.classList.add("modal-show"),storageName&&storageEmail?(nameField.value=storageName,emailField.value=storageEmail,messageField.focus()):storageName?(nameField.value=storageName,emailField.focus()):(emailField.value=storageEmail,nameField.focus())}),mapLink.addEventListener("click",function(e){e.preventDefault(),map.classList.add("modal-show")}),feedbackCloseButton.addEventListener("click",function(e){e.preventDefault(),feedback.classList.remove("modal-show"),feedback.classList.remove("modal-error")}),mapCloseButton.addEventListener("click",function(e){e.preventDefault(),map.classList.remove("modal-show")}),feedbackForm.addEventListener("submit",function(e){nameField.value&&emailField.value&&messageField.value?isStorageSupported&&(localStorage.setItem("name",nameField.value),localStorage.setItem("email",emailField.value)):(e.preventDefault(),feedback.classList.remove("modal-error"),feedback.offsetWidth=feedback.offsetWidth,feedback.classList.add("modal-error"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),feedback.classList.contains("modal-show")&&(feedback.classList.remove("modal-show"),feedback.classList.remove("modal-error")),map.classList.contains("modal-show")&&map.classList.remove("modal-show"))});for(var servicesControls=document.querySelectorAll(".services-controls button"),servicesContent=document.querySelector(".services-content").children,i=0;i<servicesControls.length;i++)addControlHandler(servicesControls,servicesContent,i,"services-content-active","button-active");var favControls=document.querySelectorAll(".popular-controls button"),favContent=document.querySelectorAll(".popular-list li");for(i=0;i<favControls.length;i++)addControlHandler(favControls,favContent,i,"popular-item-active","popular-controls-active");
